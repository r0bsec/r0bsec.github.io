<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="THM:crackthehash" /><meta name="author" content="r0bsec" /><meta property="og:locale" content="en" /><meta name="description" content="Crack the hash" /><meta property="og:description" content="Crack the hash" /><link rel="canonical" href="https://r0bsec.github.io/writeups/crackthehash/" /><meta property="og:url" content="https://r0bsec.github.io/writeups/crackthehash/" /><meta property="og:site_name" content="r0bsec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-08-17T22:44:52+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="THM:crackthehash" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@r0bsec" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"r0bsec"},"dateModified":"2023-08-17T22:44:52+00:00","datePublished":"2023-08-17T22:44:52+00:00","description":"Crack the hash","headline":"THM:crackthehash","mainEntityOfPage":{"@type":"WebPage","@id":"https://r0bsec.github.io/writeups/crackthehash/"},"url":"https://r0bsec.github.io/writeups/crackthehash/"}</script><title>THM:crackthehash | r0bsec</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="r0bsec"><meta name="application-name" content="r0bsec"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/img/favicons/favicon-32x32.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">r0bsec</a></div><div class="site-subtitle fst-italic">Cybersecurity fun and games</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/writeups/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>WRITEUPS</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/r0bsec" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>THM:crackthehash</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> THM:crackthehash</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row mb-5"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 class="dynamic-title"> THM:crackthehash</h1><div class="post-content"><p>Crack the hash</p><p>URL: <a href="https://tryhackme.com/room/crackthehash">https://tryhackme.com/room/crackthehash</a> [Easy]</p><hr /><h2 id="reconnaissance"><span class="me-2">Reconnaissance</span><a href="#reconnaissance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is not a Capture The Flag. It’s a room that has several hashes to be cracked. Description of the room:</p><blockquote><p>Cracking hashes challenges</p></blockquote><h2 id="level-1"><span class="me-2">Level 1</span><a href="#level-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>One of the first things needed is to identify what potential hash algorithms are used, based on the format of the hash. Some ways to do that is check:</p><ul><li>https://hashcat.net/wiki/doku.php?id=example_hashes<li>https://www.tunnelsup.com/hash-analyzer/</ul><p>Also from the terminal, you can use <code class="language-plaintext highlighter-rouge">hash-identifier</code>. For example:</p><blockquote><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hash-identifier CBFDAC6008F9CAB4083784CBD1874F76618D2A97
</pre></table></code></div></div></blockquote><p>Next, if these are hashes of known values with no salt applied, they might be easily crackable with <a href="https://duckduckgo.com/?q=rainbow+tables">rainbow tables</a>. For some, you can use an online resource, or you can crack them locally.</p><h3 id="cracking-online"><span class="me-2">Cracking Online</span><a href="#cracking-online" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>For example, you might try the various hashes on a site like:</p><ul><li><strong>https://crackstation.net/</strong><li><strong>https://www.onlinehashcrack.com/</strong></ul><p>Below is a summary of the hashes and their algorithm.</p><div class="table-wrapper"><table><thead><tr><th>Hash<th>Algorithm<tbody><tr><td><code class="language-plaintext highlighter-rouge">48bb6e862e54f2a795ffc4e541caed4d</code><td>md5<tr><td><code class="language-plaintext highlighter-rouge">CBFDAC6008F9CAB4083784CBD1874F76618D2A97</code><td>SHA1<tr><td><code class="language-plaintext highlighter-rouge">1C8BFE8F801D79745C4631D09FFF36C82AA37FC4CCE4FC946683D7B336B63032</code><td>SHA256<tr><td><code class="language-plaintext highlighter-rouge">$2y$12$Dwt1BZj6pcyc3Dy1FWZ5ieeUznr71EeNkJkUlypTsgbX1H68wsRom</code><td>Bcrypt-Blowfish<tr><td><code class="language-plaintext highlighter-rouge">279412f945939ba78ce0758d3fd83daa</code><td>md4</table></div><h3 id="cracking-locally"><span class="me-2">Cracking Locally</span><a href="#cracking-locally" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Another way to attempt to crack these hashes is with <code class="language-plaintext highlighter-rouge">hashcat</code>. You could put your hashes into a file called <a href="hashes_l1.txt"><code class="language-plaintext highlighter-rouge">hashes_l1.txt</code></a> for example, and then run something like this:</p><blockquote><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hashcat <span class="nt">-m</span> 0 hashes_l1.txt /usr/share/wordlists/rockyou.txt  
</pre></table></code></div></div></blockquote><p>Note that the <code class="language-plaintext highlighter-rouge">-m 0</code> is the hash “code” from the HashCat website: https://hashcat.net/wiki/doku.php?id=example_hashes - So <code class="language-plaintext highlighter-rouge">0</code> is the code for MD5 for example.</p><h3 id="special-case"><span class="me-2">Special Case</span><a href="#special-case" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Of the hashes above the one that starts with <code class="language-plaintext highlighter-rouge">$2y$12$...</code> is an unusual one. From the THM hint, we see:</p><blockquote><p><em>Search the hashcat examples page (https://hashcat.net/wiki/doku.php?id=example_hashes) for $2y$. This type of hash can take a very long time to crack, so either filter rockyou for four character words, or use a mask for four lower case alphabetical characters.</em></p></blockquote><p>When I tried to run <code class="language-plaintext highlighter-rouge">hashcat</code> against on my laptop (<em>Intel i7 7th Gen, no GPU</em>), it says it will take 11+ days to complete!</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Time</span><span class="p">.</span><span class="n">Estimated</span><span class="p">...:</span> <span class="n">Mon</span> <span class="n">Feb</span> <span class="mi">21</span> <span class="mi">14</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">25</span> <span class="mi">2022</span> <span class="p">(</span><span class="mi">11</span> <span class="n">days</span><span class="p">,</span> <span class="mi">18</span> <span class="n">hours</span><span class="p">)</span>
</pre></table></code></div></div><p>So, per the hint, let’s pull just the first 4 letters from RockYou and create a new wordlist:</p><blockquote><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">cut</span> <span class="nt">-c-4</span> /usr/share/wordlists/rockyou.txt <span class="o">&gt;</span> ./rock4.txt
</pre></table></code></div></div></blockquote><p>But then, this is going to have some duplicates and trash. We can at least get rid of the duplicates by calling <code class="language-plaintext highlighter-rouge">sort</code> and having it just include the unique (<code class="language-plaintext highlighter-rouge">-u</code>) lines, and the hint told us it’s all lower case. So, we can convert everything to lowercase, then just pull out the unique values:</p><blockquote><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">tr </span>A-Z a-z &lt; ./rock4.txt | <span class="nb">sort</span> <span class="nt">-u</span> <span class="o">&gt;</span> rock4.sorted.txt 
</pre></table></code></div></div></blockquote><p>The <code class="language-plaintext highlighter-rouge">tr</code> replaces uppercase for lowercase from the shortened <code class="language-plaintext highlighter-rouge">rock4.txt</code>, then pipes that to <code class="language-plaintext highlighter-rouge">sort</code> which will pull out the unique values, and output itself to <code class="language-plaintext highlighter-rouge">rock4.sorted.txt</code>.</p><p>This dramatically reduces the size of our wordlist:</p><div class="table-wrapper"><table><thead><tr><th>File<th style="text-align: right">Size<tbody><tr><td><code class="language-plaintext highlighter-rouge">rockyou.txt</code><td style="text-align: right">139,921,507 bytes<tr><td><code class="language-plaintext highlighter-rouge">rock4.txt</code><td style="text-align: right">71,718,690 bytes<tr><td><code class="language-plaintext highlighter-rouge">rock4.sorted.txt</code><td style="text-align: right">3,770,791 bytes</table></div><p>So we went from 139MB, to 71MB, to 3MB. However, when we re-run <code class="language-plaintext highlighter-rouge">hashcat</code>:</p><blockquote><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hashcat <span class="nt">-m</span> 3200 hashes.txt rock4.sorted.txt
</pre></table></code></div></div></blockquote><p>On my non-GPU laptop, that improved the time, but not to a reasonable level:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Time</span><span class="p">.</span><span class="n">Estimated</span><span class="p">...:</span> <span class="n">Thu</span> <span class="n">Feb</span> <span class="mi">10</span> <span class="mi">12</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">59</span> <span class="mi">2022</span> <span class="p">(</span><span class="mi">14</span> <span class="n">hours</span><span class="p">,</span> <span class="mi">55</span> <span class="n">mins</span><span class="p">)</span>
</pre></table></code></div></div><p>My guess is this would run dramatically faster on a desktop machine with a GPU.</p><h2 id="level-2"><span class="me-2">Level 2</span><a href="#level-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Below are the algorithms used for each hash. Note that these can’t be broken online, you’ll need to use <code class="language-plaintext highlighter-rouge">hashcat</code> for these.</p><div class="table-wrapper"><table><thead><tr><th>Hash<th>Algorithm<tbody><tr><td><code class="language-plaintext highlighter-rouge">F09EDCB1FCEFC6DFB23DC3505A882655FF77375ED8AA2D1C13F640FCCC2D0C85</code><td>SHA2-256<tr><td><code class="language-plaintext highlighter-rouge">1DFECA0C002AE40B8619ECF94819CC1B</code><td>NTLM<tr><td><code class="language-plaintext highlighter-rouge">$6$aReallyHardSalt$6WKUTqzq.UQQmrm0p/T7MPpMbGNnzXPMAXi4bJMl9be.cfi3/qxIf.hsGpS41BqMhSrHVXgMpdjS6xeKZAs02.</code><td>sha512crypt $6$, SHA512 (Unix)<tr><td><code class="language-plaintext highlighter-rouge">e5d8870e5bdd26602cab8dbe07a942c8669e56d6</code><td>HMAC-SHA1</table></div><blockquote><h3 id="note"><span class="me-2"><strong>NOTE:</strong></span><a href="#note" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>For the last one on Level 2, <code class="language-plaintext highlighter-rouge">hashcat</code> expects the hash to be <code class="language-plaintext highlighter-rouge">hash:salt</code> type format.</p></blockquote><h2 id="summary"><span class="me-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Completed: [2022-02-09 22:27:21]</p></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/chirpy/">chirpy</a> <a class="post-tag btn btn-outline-primary" href="/tags/documentation/">documentation</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/techno-tim/">techno-tim</a></div></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/chirpy/">chirpy</a> <a class="post-tag btn btn-outline-primary" href="/tags/documentation/">documentation</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/techno-tim/">techno-tim</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a></p><p>© 2023 <a href="https://github.com/r0bsec">r0bsec</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div></div></footer><div id="mask"></div><button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/page.min.js"></script> <script defer src="/app.js"></script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
